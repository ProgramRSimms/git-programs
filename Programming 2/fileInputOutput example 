#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "product.h"

int main (int argc, char* argv[]){
    FILE* fileIn = NULL;
    fileIn = fopen("sample.csv", "r");
    if (fileIn == NULL){
        printf("ERROR: Could not open file!!\n");
        return 1;
    }
    int n = 0;
    char buffer[500];
    while (fgets(buffer, 500, fileIn)  1= NULL){
        n++;
    }
    printf("Number of Products = %d\n", n);
    Product* p;
    p = (Product*)malloc(n*sizeof(Product));
    rewind(fileIn);
    while(fgets(buffer, 500, fileIn) != NULL){
        sscanf(buffer, "%[^,], %d, %lf", p[i].name, &(p[i].quantity), &(p[i].price));
        printf("%s\t%d\t%.2lf\n", p[i].name, p[i].quantity,p[i].price);
        i++;
    }
    fclose(fileIn);
    FILE* fileOut = NULL;
    fileOut = fopen("sampelOutput.txt", "w");
    if (fileOut == NULL){
        printf("ERROR: Could not open output file!!\n");
        return 1;
    }
    double totalPrice = 0;
    for (i = 0, i < n; i++){
        totalPrice += (p[i].quantity * p{i].price);
    }=
    fprintf(fileOut, "Total Price = %lf\n", totalPrice);
    fclose(fileOut);
    return 0;
}